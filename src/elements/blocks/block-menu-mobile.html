<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../styles/shared.html">

<dom-module id="block-menu-mobile">
  <template>
    <style include="shared">
      .overlay {
        position: absolute;
        width: 0;
        height: 100vh;
        background: #000;
        opacity: 0;
        left: 0;
        top: 0;
        z-index: 1000;
        -webkit-transition: width 0; 
        transition: width 0;
        -webkit-transition: opacity .2s; 
        transition: opacity .2s;
      }

      [show].overlay {
        width: 100vw;
        opacity: 0.5;
      }

      .menu {
        position: absolute;
        height: 100vh;
        width: 0;
        left: 0;
        top: 0;
        
        background: #333;
        color: #fff;
        opacity: 1;

        -webkit-transition: width .2s; 
        transition: width .2s;
        z-index: 1001;
        overflow-x:hidden;
      }

      [show].menu {
        width: 300px;
      }

      [show].menu a {
        color: #FFF;
      }

      ul {
        padding: 1rem 0;
        list-style-type: none;
        margin: 0;
        font-size: 1.3rem;
        font-weight: 200;
        /*width: 268px;*/
        overflow: hidden;

/*        -webkit-transition: all 0s; 
        transition: all 0s;*/
      }
      li {
        padding: 0.25rem 0 0.25rem;
        border-bottom: 1px dotted #777;
      }
      ul > li {
        border: 0;
      }
      ul > li > a {
        display: block;
        border-bottom: 1px solid #999;
      }
      ol {
        list-style-type: none;
        margin: 0;
        padding: 0 0 0.2rem;
      }
      ol li {
        padding-left: 1rem;
        height: 40px;
        overflow: hidden;
      }
      li a {
        color:#fff;
        text-decoration: none;
        padding: .2rem .5rem .2rem 1rem;
      }
      li a:hover {
        color:#cc0002;
      }


    </style>


    <div class="overlay" show$="[[show]]" on-tap="_hide"></div>

    <div id="menu" class="menu" show$="[[show]]">

      <ul>
        <template is="dom-repeat" items="{{menu}}">

          <li>
            <a on-tap="_closeTop">[[item.text]]</a>

            <ol hidden$="{{!item.sub}}">

              <template is="dom-repeat" items="{{item.sub}}" as="sub">
                <li><a on-tap="_close">[[sub.text]]</a></li>
              </template>

            </ol>

          </li>

        </template>
      </ul>


    </div>
      
    
  </template>

  <script>
  
    class BlockMenuMobile extends Polymer.GestureEventListeners(Polymer.Element) {
      static get is() { return 'block-menu-mobile'; }
      static get properties() {
        return {

          menu: {
            type: Object
          },

          show: {
            type: Boolean,
            value: false,
            notify: true,
            observer: '_showChanged'
          }
          
        };
      }

      _showChanged() {
        let body = document.getElementsByTagName("body")[0];
        this.$.menu.scrollTop = 0;

        if(this.show) {
          body.className = "mobileMenu";
        } else {
          body.className = "";
        }
      }

      _hide(e) {
        e.preventDefault();
        e.stopPropagation();
        this.show = false;
      }

      _close(e) {
        location.hash = e.model.sub.link;
        this.show = false;
      }

      _closeTop(e) {
        location.hash = e.model.item.link;
        this.show = false;
      }
    }

    window.customElements.define(BlockMenuMobile.is, BlockMenuMobile);
  </script>
</dom-module>
